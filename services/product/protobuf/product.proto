syntax = "proto3";

package product;
option go_package = "github.com/SomeHowMicroservice/shm-be/services/product/protobuf";

service ProductService {
  rpc CreateCategory(CreateCategoryRequest) returns (CreatedResponse);

  rpc GetCategoryTree(GetCategoryTreeRequest) returns (CategoryTreeResponse);

  rpc CreateProduct(CreateProductRequest) returns (CreatedResponse);

  rpc GetProductBySlug(GetProductBySlugRequest) returns (ProductPublicResponse);

  rpc CreateColor(CreateColorRequest) returns (CreatedResponse);

  rpc CreateSize(CreateSizeRequest) returns (CreatedResponse);

  rpc CreateVariant(CreateVariantRequest) returns (CreatedResponse);

  rpc CreateImage(CreateImageRequest) returns (CreatedResponse);

  rpc GetProductsByCategory(GetProductsByCategoryRequest) returns (ProductsPublicResponse);
}

message GetProductsByCategoryRequest {
  string slug = 1;
}

message ProductsPublicResponse {
  repeated ProductPublicResponse products = 1;
}

message CreateImageRequest {
  string product_id = 1;
  string color_id = 2;
  bytes file = 3;
  string file_name = 4;
  bool is_thumbnail = 5;
  int32 sort_order = 6;
  string user_id = 7;
}

message CreateVariantRequest {
  string sku = 1;
  string product_id = 2;
  string color_id = 3;
  string size_id = 4;
  int64 quantity = 5;
  string user_id = 6;
}

message CreateSizeRequest {
  string name = 1;
  string user_id = 2;
}

message CreateColorRequest {
  string name = 1;
  string user_id = 2;
}

message CreatedResponse {
  string id = 1;
}

message GetProductBySlugRequest {
  string slug = 1;
}

message ProductPublicResponse {
  string id = 1;
  string title = 2;
  string slug = 3;
  string description = 4;
  float price = 5;
  optional bool is_sale = 6;
  optional float sale_price = 7;
  optional string start_sale = 8;
  optional string end_sale = 9;
  repeated BaseCategoryResponse categories = 10;
  repeated BaseVariantResponse variants = 11;
  repeated BaseImageResponse images = 12;
}

message BaseImageResponse {
  string id = 1;
  BaseColorResponse color = 2;
  string url = 3;
  int32 sort_order = 4;
  bool is_thumbnail = 5;
}

message BaseColorResponse {
  string id = 1;
  string name = 2;
}

message BaseSizeResponse {
  string id = 1;
  string name = 2;
}

message BaseInventoryResponse {
  string id = 1;
  int64 sold_quantity = 2;
  int64 stock = 3;
  optional bool is_stock = 4;
}

message BaseVariantResponse {
  string id = 1;
  string sku = 2;
  BaseColorResponse color = 3;
  BaseSizeResponse size = 4;
  BaseInventoryResponse inventory = 5;
}

message CreateCategoryRequest {
  string name = 1;
  optional string slug = 2;
  repeated string parent_ids = 3;
  string user_id = 4;
}

message CreateProductRequest {
  string title = 1;
  string description = 2;
  float price = 3;
  bool is_sale = 4;
  optional float sale_price = 5;
  optional string start_sale = 6;
  optional string end_sale = 7;
  repeated string category_ids = 8;
  string user_id = 9;
}

message BaseCategoryResponse {
  string id = 1;
  string name = 2;
  string slug = 3;
}

message CategoryPublicResponse {
  string id = 1;
  string name = 2;
  string slug = 3;
  repeated CategoryPublicResponse children = 4;
}

message GetCategoryTreeRequest {}

message CategoryTreeResponse {
  repeated CategoryPublicResponse categories = 1;
}